(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&o(i)}).observe(document,{childList:!0,subtree:!0});function r(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function o(n){if(n.ep)return;n.ep=!0;const c=r(n);fetch(n.href,c)}})();function b(e,t){let r=0;t.length!==0?r=t[t.length-1].id+1:r=0;const o=e[0].toUpperCase()+e.slice(1);return t.push({id:r,text:o,done:!1,mode:"view"}),r}function C(e,t){const r=e.find(o=>o.id===Number(t.dataset.id));if(r){const o=t.querySelector("input").value.trim();if(x(o))r.text=t.dataset.oldText,r.error="Vous ne pouvez pas modifier la tâche pour être vide";else{const n=o[0].toUpperCase()+o.slice(1);r.text=n,delete r.oldText,delete r.error}r.mode="view"}return r}function B(e,t){return e.map(o=>o.id===Number(t)?{...o,done:!o.done}:o)}function L(e,t){return e=e.filter(r=>r.id!==Number(t)),e}function x(e){return e.trim()===""}function g(e){const t=document.createTextNode(e),r=document.createElement("p");return r.setAttribute("class","error"),r.append(t),r}function p(e,t){const r=document.createTextNode(t),o=document.createElement("button");return o.setAttribute("class",e),o.append(r),y(o),o}function N(e){const t=document.createTextNode(e),r=document.createElement("p");return r.append(t),r}function A(){const e=document.createElement("span");return e.setAttribute("class","todo"),e}function I(e){const t=document.querySelector(`li[data-id='${e}']`);t&&t.remove()}function O(e,t){e.dataset.oldText=t.text;const r=document.createElement("input");return r.setAttribute("type","text"),r.setAttribute("class","taskInput"),r.value=t.text,r}function a(e){const t=[{fromClass:"edit",toClass:"validate",fromText:"Editer",toText:"Valider"},{fromClass:"delete",toClass:"cancel",fromText:"Supprimer",toText:"Annuler"}],r=document.createElement("li");r.dataset.id=e.id,r.dataset.mode=e.mode;const o=A(),n=p("edit","Editer"),c=p("delete","Supprimer"),i=e.mode==="view"?N(e.text):O(r,e);return d(o,"unavailable",e.mode==="edit"),r.append(o,i,n,c),e.done&&h(r,e),m(e,n,t[0]),m(e,c,t[1]),d(r,"edit-mode",e.mode==="edit"),r}function h(e,t){const r=e.querySelector("span"),o=e.querySelector("p"),n=e.querySelector(".edit");d(r,"done",t.done),d(o,"crossed",t.done),d(n,"hide",t.done)}function d(e,t,r){r?e.classList.add(t):e.classList.remove(t)}function m(e,t,r){t.classList.add(e.mode==="view"?r.fromClass:r.toClass),t.classList.remove(e.mode==="view"?r.toClass:r.fromClass),t.textContent=e.mode==="view"?r.fromText:r.toText,y(t)}function y(e){const t=document.createElement("i");switch(e.textContent){case"Editer":e.classList.add("ternary-color"),e.classList.remove("main-color"),t.className="fa-solid fa-pen";break;case"Supprimer":case"Annuler":t.className="fa-regular fa-circle-xmark",e.classList.add("secondary-color");break;case"Valider":e.classList.remove("ternary-color"),e.classList.add("main-color"),t.className="fa-regular fa-circle-check";break}e.prepend(t)}function D(e,t){if(e.target.closest("form button")){e.preventDefault();const o=e.target.closest("form"),n=o.querySelector("input"),c=n.value.trim();let i;if(x(c))i=g("Vous ne pouvez pas ajouter une tâche vide"),o.parentElement.querySelector(".error")||o.after(i);else{const v=b(c,t),S=t.find(q=>q.id===v),T=a(S);document.querySelector("ul").prepend(T),E()}n.value="",n.focus()}}function j(e,t){if(e.target.closest(".delete")){const o=e.target.closest("li");t=L(t,o.dataset.id),I(o.dataset.id)}return t}function l(e,t,r){const o=e.target.closest("li");r&&M(t,o),(e.target.closest(".validate")||e.key==="Enter")&&(P(t,o),E()),(e.target.closest(".cancel")||e.key==="Escape")&&$(t,o)}function k(e,t){const r=e.target.closest("span"),o=e.target.closest("li");if(r&&o.dataset.mode==="view"){const n=e.target.closest("li");t=B(t,n.dataset.id),h(n,t.find(c=>c.id===Number(n.dataset.id)))}return t}function M(e,t){const r=e.find(c=>{if(c.id===Number(t.dataset.id))return c});r&&(r.mode="edit");const o=a(r),n=o.querySelector("input");t.replaceWith(o),n.focus(),n.select()}function P(e,t){const r=C(e,t);if(r.error){const o=g(r.error);t.parentElement.querySelector(".error")||t.after(o)}if(r){const o=a(r);t.replaceWith(o)}}function $(e,t){const r=e.find(n=>n.id===Number(t.dataset.id));r.text=t.dataset.oldText,r.mode="view";const o=a(r);t.replaceWith(o)}function z(e){const t=e.target.parentElement.querySelector(".error");t&&t.remove()}function E(){const e=document.querySelector(".error");e&&e.remove()}let s=[{id:1,text:"empêcher l'ajout de todo vide",done:!0,mode:"view"},{id:2,text:"mettre une majuscule à la première lettre du texte de la todo",done:!0,mode:"view"},{id:3,text:"barrer le texte de la todo lorsqu'elle est terminée",done:!0,mode:"view"},{id:4,text:"Ajouter un curseur pointer sur les todos",done:!1,mode:"view"},{id:5,text:"Ajouter un effet hover sur les todos pour mieux voir celle sur laquelle l'utilisateur va cliquer",done:!0,mode:"view"},{id:6,text:"Créer des classes pour colorer les boutons",done:!0,mode:"view"},{id:7,text:"Lors de l'édition, ajoutez un écouteur pour sauvegarder avec la touche entrée si le champ est focus ou annuler avec la touche escape",done:!0,mode:"view"},{id:8,text:"Rendre l'édition possible sur un double clic",done:!1,mode:"view"},{id:9,text:"[ Avancé ] : empêcher le double clic de changer le statut deux fois de suite de la todo",done:!1,mode:"view"},{id:10,text:"[ Avancé ] : focus l'input après l'édition",done:!0,mode:"view"}];function w(e,t,r){return e>1?r:t}const V=document.querySelector("h1"),u=document.createElement("span");V.prepend(u);u.textContent=`${s.length} ${w(s.length,"chose","choses")} `;const f=document.querySelector(".container");U();f.addEventListener("click",e=>{D(e,s),s=j(e,s),s=k(e,s),l(e,s,e.target.closest(".edit")),z(e),u.textContent=`${s.length} ${w(s.length,"chose","choses")} `});f.addEventListener("keydown",e=>{const t=e.target.closest("li");if(!t)return;t.dataset?.mode==="edit"&&(e.key==="Escape"||e.key==="Enter")&&(e.key==="Enter"&&e.preventDefault(),l(e,s))});f.addEventListener("dblclick",e=>{e.target.closest("li").querySelector("span").classList.contains("done")||l(e,s,e.target.closest("p"))});function U(){const e=document.querySelector("ul");e.innerHTML="",s.forEach(t=>{const r=t.text[0].toUpperCase()+t.text.slice(1);t.text=r;const o=a(t);e.prepend(o)}),console.log(s)}
